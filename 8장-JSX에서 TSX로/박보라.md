# 8장 - JSX에서 TSX로

## 8.1 리액트 컴포넌트 타입

### 클래스 컴포넌트 타입 지정

```ts
/* React Component */
interface Componet<P = {}, S = {}, SS = any>extends ComponentLifeCycle<P, S, SS>{}

class Component <P, S> {
    /* 생략 */
}

/* React Pure Component */
class PureComponent<P = {}, S = {}, SS = any> extends Component<P, S, SS> {}
```

P : Props

S : State

```ts
import React from "react";

interface WelcomeProps {
    name: string;
}

class Welcome extends React.Component<WelcomeProps> {
    /* 생략 */
}
```

### 함수 컴포넌트 타입

```ts
function Welcome(props: WelcomeProps): JSX.Element {}

const Welcome2: React.FC<WelcomeProps> = ({ name }) => {};

const Welcome3: React.VFC<WelcomeProps> = ({ name }) => {};

const Welcome4 = ({ name }: WelcomeProps): JSX.Element => {}

type FC<P = {}> = FunctionComponent<P>;

interface FunctionComponent <P = {}> {
    (props: PropsWithChildren<P>, context?: any): ReactElement<any, any> | null;
    propTypes?: WeakValidationMap<P> | undefined;
    contextTypes?: ValidationMap<any> | undefined;
    defaultProps?: Partial<P> | undefined;
    displayName?: string | undefined;
}

type VFC <P = {}> = VoidFunctionComponent<P>;

interface VoidFunctionComponent <P = {}>{
    (props: P, context?: any): ReactElement<any, any> | null;
    propTypes?: WeakValidationMap<P> | undefined;
    contextTypes?: ValidationMap<any> | undefined;
    defaultProps?: Partial<P> | undefined;
    displayName?: string | undefined;
}
```

React.FC : Function Component

React.VFC : Void Function Component (v18 이후 삭제)

### Children Props

```ts
type PropsWithChildren<P> = P & { children?: ReactNode | undefined };
```

### React.ReactElement vs JSX.Element vs React.ReactNode

모두 리액트의 요소를 나타내는 타입

#### 1. React.ReactElement

함수 컴포넌트의 반환 타입 : `ReactElement`

리액트 컴포넌트를 객체 형태로 저장하기 위한 포맷

JSX의 createElement 메서드 호출로 생성된 리액트 앨리먼트를 나타내는 타입

```ts
interface reactElement<P = any, T extends string | JSXElementConstructor<any> = string | JSXElementConstructor<any>> {
    type: T;
    props: P;
    key: Key | null;
}
```

- 사용 예시
  ```tsx
  import type { JSX } from "react";
  import VercelIcon from "vercel.svg";
  
  interface IconProps {
    size: number;
  }
  
  interface Props {
    icon: React.ReactElement<IconProps>;
  }
  
  export const Item = ({ icon }: Props) => {
  const iconSize = icon.props.size;
  
  return <div>{icon}</div>;
  };
  
  export const Test = () => {
  return <Item icon={<VercelIcon size={10} />} />;
  };

  ```

#### 2. JSX.Element

ReactElement의 특정 타입으로 Props와 타입 필드를 모두 `<any, any>`로 가지는 타입

```ts
declare global {
    namespace JSX {
        interface Element extends React.ReactElement<any, any> {}
    }
}
```

- 사용 예시
  - 리액트 엘리먼트를 props로 전달 받는 render props 패턴 
  ```tsx
  import type { JSX } from "react";
  import VercelIcon from "vercel.svg";
  
  interface Props {
    icon: JSX.Element;
  }
  export const Item = ({ icon }: Props) => {
    const iconSize = icon.props.size;
    
    return <div>{icon}</div>;
  };
  
  export const Test = () => {
    return <Item icon={<VercelIcon size={10} />} />;
  };

  ```


#### 3. React.ReactNode

ReactChild : React Element | string | number

ReactNode : ReactChild | null | undefined | boolean .. 가장 넓은 범주의 타입

리액트의 render 함수가 반환할 수 있는 모든 형태

```ts
type ReactText = string | number;
type ReactChild = ReactElement | ReactText;
type ReactFragment = {} | Iterable<ReactNode>;

type ReactNode = 
    | ReactChilde
    | ReactFragment
    | ReactPortal
    | boolean
    | null
    | undefined;

type ComponentType<P = {}> = ComponentClass<P> | FunctinoComponent<P>;
```

- 사용 예시
    - 리액트가 가질 수 있는 모든 타입
    - 리액트의 Composition(합성) 모델 - props로 children를 많이 사용함
    ```ts
    interface MyComponentProps {
        children?: React.ReactNode; // <- 어떤 타입이든 children으로 들어올 수 있음을 의미
        //...
    }
    ```
    - 리액트 내장 타입인 PropsWithChildren도 `ReactNode` 타입 사용함
    ```ts
    type PropsWithChildren<P = unknown> = P & {
        children?: React.ReactNode | undefined;
    } 
    ```

### 리액트에서 기본 HTML 요소 타입 활용하기

기존 html 태그를 확장한 컴포넌트 (ex. 버튼)

기존에 버튼에서 제공하는 모든 메서드를 지원해야 일관성, 편의성 제공 가능하다.

1. DetailedHTMLProps

```ts
type NativeButtonProps = React.DetailedHTMLProps<React.ButtonHTMLAttributes<HTMLButtonElement>, HTMLButtonElement>

type ButtonProps = NativeButtonProps & {
  status?: ButtonStatus;
  onClick?: NativeButtonProps["onClick"];
}

const Button = (props: ButtonProps) => { /* 생략... */}
```


2. ComponentPropsWithoutRef

```ts
type NativeButtonProps = React.ComponentPropsWithoutRef<"button">;
type ButtonProps = NativeButtonProps & {
  status?: ButtonStatus;
  onClick?: NativeButtonProps["onClick"];
}
```

## 8.2 TS로 리액트 컴포넌트 만들기

### JSX

```jsx
export const Select = ({ onChange, options, selectedOption }) => {
  const handleChange = (e) => {
    const selected = Object.entries(options).fine((_, value) => value === e.target.value?.[0]);
    onChange(selected);
  };

  return (
    <select
      name="pets"
      id="pet-select"
      value={selectedOption && options[selectedOption]}
      onChange={handleChange}
    >
      {Object.entries(options).map(([key, value]) => (
        <option key={key} value={value}>
          {value}
        </option>
      ))}
    </select>
  );
};
```

타입을 알 수 없음
options에 어떤 값들이 들어올지 예상이 안됨

### JSDocs

```jsx
/**
 * Select Component
 * @param {Object} props
 * @param {Object} props.options - { [key: string]: string}
 * @param {string | undefined} props.selectedOption
 * @param {function} props.onChange - 선택된 옵션이 변경될 때 호출되는 콜백 함수 (optional)
 * @returns {JSX.Element}
 */
export const Select = ({ onChange, options, selectedOption }) => {
  const handleChange = (e) => {
    const selected = Object.entries(options).find((_, value) => value === e.target.value?.[0]);
    onChange?.(selected);
  };

  return (
    <select
      name="pets"
      id="pet-select"
      value={selectedOption && options[selectedOption]}
      onChange={handleChange}
    >
      {Object.entries(options).map(([key, value]) => (
        <option key={key} value={value}>
          {value}
        </option>
      ))}
    </select>
  );
};
```

여전히 options에 어떤 값이 들어오는지, onChange의 매개변수로 어떤 값들이 들어오는지 파악이 안됨

### props 인터페이스 적용

```tsx
import type { ChangeEvent } from "react";

type Options = Record<string, string>; //{ [key: string]: string };

type SelectProps = {
  options: Options;
  selectedOption?: string;
  onChange?: (selected?: string) => void;
};

export const Select = ({ onChange, options, selectedOption }: SelectProps) => {
  const handleChange = (e: ChangeEvent<HTMLSelectElement>) => {
    const selected = Object.entries(options).find(([_, value]) => value === e.target.value)?.[0];
    onChange?.(selected);
  };

  return (
    <select
      name="pets"
      id="pet-select"
      value={selectedOption && options[selectedOption]}
      onChange={handleChange}
    >
      {Object.entries(options).map(([key, value]) => (
        <option key={key} value={value}>
          {value}
        </option>
      ))}
    </select>
  );
};

```