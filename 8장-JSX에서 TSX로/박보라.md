# 8ì¥ - JSXì—ì„œ TSXë¡œ

## 8.1 ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ íƒ€ì…

### í´ë˜ìŠ¤ ì»´í¬ë„ŒíŠ¸ íƒ€ì… ì§€ì •

```ts
/* React Component */
interface Componet<P = {}, S = {}, SS = any>extends ComponentLifeCycle<P, S, SS>{}

class Component <P, S> {
    /* ìƒëµ */
}

/* React Pure Component */
class PureComponent<P = {}, S = {}, SS = any> extends Component<P, S, SS> {}
```

P : Props

S : State

```ts
import React from "react";

interface WelcomeProps {
    name: string;
}

class Welcome extends React.Component<WelcomeProps> {
    /* ìƒëµ */
}
```

### í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸ íƒ€ì…

```ts
function Welcome(props: WelcomeProps): JSX.Element {}

const Welcome2: React.FC<WelcomeProps> = ({ name }) => {};

const Welcome3: React.VFC<WelcomeProps> = ({ name }) => {};

const Welcome4 = ({ name }: WelcomeProps): JSX.Element => {}

type FC<P = {}> = FunctionComponent<P>;

interface FunctionComponent <P = {}> {
    (props: PropsWithChildren<P>, context?: any): ReactElement<any, any> | null;
    propTypes?: WeakValidationMap<P> | undefined;
    contextTypes?: ValidationMap<any> | undefined;
    defaultProps?: Partial<P> | undefined;
    displayName?: string | undefined;
}

type VFC <P = {}> = VoidFunctionComponent<P>;

interface VoidFunctionComponent <P = {}>{
    (props: P, context?: any): ReactElement<any, any> | null;
    propTypes?: WeakValidationMap<P> | undefined;
    contextTypes?: ValidationMap<any> | undefined;
    defaultProps?: Partial<P> | undefined;
    displayName?: string | undefined;
}
```

React.FC : Function Component

React.VFC : Void Function Component (v18 ì´í›„ ì‚­ì œ)

### Children Props

```ts
type PropsWithChildren<P> = P & { children?: ReactNode | undefined };
```

### React.ReactElement vs JSX.Element vs React.ReactNode

ëª¨ë‘ ë¦¬ì•¡íŠ¸ì˜ ìš”ì†Œë¥¼ ë‚˜íƒ€ë‚´ëŠ” íƒ€ì…

#### 1. React.ReactElement

í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸ì˜ ë°˜í™˜ íƒ€ì… : `ReactElement`

ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ê°ì²´ í˜•íƒœë¡œ ì €ì¥í•˜ê¸° ìœ„í•œ í¬ë§·

JSXì˜ createElement ë©”ì„œë“œ í˜¸ì¶œë¡œ ìƒì„±ëœ ë¦¬ì•¡íŠ¸ ì•¨ë¦¬ë¨¼íŠ¸ë¥¼ ë‚˜íƒ€ë‚´ëŠ” íƒ€ì…

```ts
interface reactElement<P = any, T extends string | JSXElementConstructor<any> = string | JSXElementConstructor<any>> {
    type: T;
    props: P;
    key: Key | null;
}
```

- ì‚¬ìš© ì˜ˆì‹œ
  ```tsx
  import type { JSX } from "react";
  import VercelIcon from "vercel.svg";
  
  interface IconProps {
    size: number;
  }
  
  interface Props {
    icon: React.ReactElement<IconProps>;
  }
  
  export const Item = ({ icon }: Props) => {
  const iconSize = icon.props.size;
  
  return <div>{icon}</div>;
  };
  
  export const Test = () => {
  return <Item icon={<VercelIcon size={10} />} />;
  };

  ```

#### 2. JSX.Element

ReactElementì˜ íŠ¹ì • íƒ€ì…ìœ¼ë¡œ Propsì™€ íƒ€ì… í•„ë“œë¥¼ ëª¨ë‘ `<any, any>`ë¡œ ê°€ì§€ëŠ” íƒ€ì…

```ts
declare global {
    namespace JSX {
        interface Element extends React.ReactElement<any, any> {}
    }
}
```

- ì‚¬ìš© ì˜ˆì‹œ
  - ë¦¬ì•¡íŠ¸ ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ propsë¡œ ì „ë‹¬ ë°›ëŠ” render props íŒ¨í„´ 
  ```tsx
  import type { JSX } from "react";
  import VercelIcon from "vercel.svg";
  
  interface Props {
    icon: JSX.Element;
  }
  export const Item = ({ icon }: Props) => {
    const iconSize = icon.props.size;
    
    return <div>{icon}</div>;
  };
  
  export const Test = () => {
    return <Item icon={<VercelIcon size={10} />} />;
  };

  ```


#### 3. React.ReactNode

ReactChild : React Element | string | number

ReactNode : ReactChild | null | undefined | boolean .. ê°€ì¥ ë„“ì€ ë²”ì£¼ì˜ íƒ€ì…

ë¦¬ì•¡íŠ¸ì˜ render í•¨ìˆ˜ê°€ ë°˜í™˜í•  ìˆ˜ ìˆëŠ” ëª¨ë“  í˜•íƒœ

```ts
type ReactText = string | number;
type ReactChild = ReactElement | ReactText;
type ReactFragment = {} | Iterable<ReactNode>;

type ReactNode = 
    | ReactChilde
    | ReactFragment
    | ReactPortal
    | boolean
    | null
    | undefined;

type ComponentType<P = {}> = ComponentClass<P> | FunctinoComponent<P>;
```

- ì‚¬ìš© ì˜ˆì‹œ
    - ë¦¬ì•¡íŠ¸ê°€ ê°€ì§ˆ ìˆ˜ ìˆëŠ” ëª¨ë“  íƒ€ì…
    - ë¦¬ì•¡íŠ¸ì˜ Composition(í•©ì„±) ëª¨ë¸ - propsë¡œ childrenë¥¼ ë§ì´ ì‚¬ìš©í•¨
    ```ts
    interface MyComponentProps {
        children?: React.ReactNode; // <- ì–´ë–¤ íƒ€ì…ì´ë“  childrenìœ¼ë¡œ ë“¤ì–´ì˜¬ ìˆ˜ ìˆìŒì„ ì˜ë¯¸
        //...
    }
    ```
    - ë¦¬ì•¡íŠ¸ ë‚´ì¥ íƒ€ì…ì¸ PropsWithChildrenë„ `ReactNode` íƒ€ì… ì‚¬ìš©í•¨
    ```ts
    type PropsWithChildren<P = unknown> = P & {
        children?: React.ReactNode | undefined;
    } 
    ```

### ë¦¬ì•¡íŠ¸ì—ì„œ ê¸°ë³¸ HTML ìš”ì†Œ íƒ€ì… í™œìš©í•˜ê¸°

ê¸°ì¡´ html íƒœê·¸ë¥¼ í™•ì¥í•œ ì»´í¬ë„ŒíŠ¸ (ex. ë²„íŠ¼)

ê¸°ì¡´ì— ë²„íŠ¼ì—ì„œ ì œê³µí•˜ëŠ” ëª¨ë“  ë©”ì„œë“œë¥¼ ì§€ì›í•´ì•¼ ì¼ê´€ì„±, í¸ì˜ì„± ì œê³µ ê°€ëŠ¥í•˜ë‹¤.

1. DetailedHTMLProps

```ts
type NativeButtonProps = React.DetailedHTMLProps<React.ButtonHTMLAttributes<HTMLButtonElement>, HTMLButtonElement>

type ButtonProps = NativeButtonProps & {
  status?: ButtonStatus;
  onClick?: NativeButtonProps["onClick"];
}

const Button = (props: ButtonProps) => { /* ìƒëµ... */}
```


2. ComponentPropsWithoutRef

```ts
type NativeButtonProps = React.ComponentPropsWithoutRef<"button">;
type ButtonProps = NativeButtonProps & {
  status?: ButtonStatus;
  onClick?: NativeButtonProps["onClick"];
}
```

## 8.2 TSë¡œ ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ ë§Œë“¤ê¸°

### JSX

```jsx
export const Select = ({ onChange, options, selectedOption }) => {
  const handleChange = (e) => {
    const selected = Object.entries(options).fine((_, value) => value === e.target.value?.[0]);
    onChange(selected);
  };

  return (
    <select
      name="pets"
      id="pet-select"
      value={selectedOption && options[selectedOption]}
      onChange={handleChange}
    >
      {Object.entries(options).map(([key, value]) => (
        <option key={key} value={value}>
          {value}
        </option>
      ))}
    </select>
  );
};
```

íƒ€ì…ì„ ì•Œ ìˆ˜ ì—†ìŒ
optionsì— ì–´ë–¤ ê°’ë“¤ì´ ë“¤ì–´ì˜¬ì§€ ì˜ˆìƒì´ ì•ˆë¨

### JSDocs

```jsx
/**
 * Select Component
 * @param {Object} props
 * @param {Object} props.options - { [key: string]: string}
 * @param {string | undefined} props.selectedOption
 * @param {function} props.onChange - ì„ íƒëœ ì˜µì…˜ì´ ë³€ê²½ë  ë•Œ í˜¸ì¶œë˜ëŠ” ì½œë°± í•¨ìˆ˜ (optional)
 * @returns {JSX.Element}
 */
export const Select = ({ onChange, options, selectedOption }) => {
  const handleChange = (e) => {
    const selected = Object.entries(options).find((_, value) => value === e.target.value?.[0]);
    onChange?.(selected);
  };

  return (
    <select
      name="pets"
      id="pet-select"
      value={selectedOption && options[selectedOption]}
      onChange={handleChange}
    >
      {Object.entries(options).map(([key, value]) => (
        <option key={key} value={value}>
          {value}
        </option>
      ))}
    </select>
  );
};
```

ì—¬ì „íˆ optionsì— ì–´ë–¤ ê°’ì´ ë“¤ì–´ì˜¤ëŠ”ì§€, onChangeì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ì–´ë–¤ ê°’ë“¤ì´ ë“¤ì–´ì˜¤ëŠ”ì§€ íŒŒì•…ì´ ì•ˆë¨

### props ì¸í„°í˜ì´ìŠ¤ ì ìš©

```tsx
import type { ChangeEvent } from "react";

type Options = Record<string, string>; //{ [key: string]: string };

type SelectProps = {
  options: Options;
  selectedOption?: string;
  onChange?: (selected?: string) => void;
};

export const Select = ({ onChange, options, selectedOption }: SelectProps) => {
  const handleChange = (e: ChangeEvent<HTMLSelectElement>) => {
    const selected = Object.entries(options).find(([_, value]) => value === e.target.value)?.[0];
    onChange?.(selected);
  };

  return (
    <select
      name="pets"
      id="pet-select"
      value={selectedOption && options[selectedOption]}
      onChange={handleChange}
    >
      {Object.entries(options).map(([key, value]) => (
        <option key={key} value={value}>
          {value}
        </option>
      ))}
    </select>
  );
};

```

### ë¦¬ì•¡íŠ¸ ì´ë²¤íŠ¸

ë¦¬ì•¡íŠ¸ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆëŠ” ì¹´ë©œ ì¼€ì´ìŠ¤ë¡œ í‘œê¸°í•¨ (`onClick`, `onChange`)

ë¸Œë¼ìš°ì €ì˜ ê³ ìœ í•œ ì´ë²¤íŠ¸ì™€ ë™ì¼í•˜ê²Œ ë™ì‘í•˜ì§€ ì•ŠìŒ

ëŒ€ì‹ , í•©ì„± ì´ë²¤íŠ¸ `SyntheticEvent` ì œê³µ

ì´ë²¤íŠ¸ ë²„ë¸”ë§ ë‹¨ê³„ì—ì„œ í˜¸ì¶œë¨

(ì°¸ê³ : ìº¡ì³ë§ ë‹¨ê³„ì—ì„œ í˜¸ì¶œí•˜ê³  ì‹¶ìœ¼ë©´ `-Capture`ë¥¼ ë¶™ì—¬ì•¼ í•¨ (ì˜ˆ: `onClickCapture`))

```ts
type EventHandler<Event extends React.SyntheticEvent> = (e: Event) => void | null;
type ChangeHandler = EventHandler<ChangeEvent<HTMLSelectElement>>;

// case 1 - ë„¤ì´í‹°ë¸Œ DOM ì´ë²¤íŠ¸ ì“¸ ë–„
const handleChange1: GlobalEventHandlers["onchange"] = (e) => {
  e.target.value // valueê°€ ì¶”ë¡ ì´ ì•ˆë¨
  
  // ë§Œì•½ ì“°ê³  ì‹¶ë‹¤ë©´ íƒ€ì…ì„ ì¢í˜€ì„œ ì‚¬ìš©í•´ì•¼ í•¨
  /*
  * const tgt = e.target;            // EventTarget | null
  * if (tgt instanceof HTMLInputElement) {
  *   console.log(tgt.value);        // ì¢í˜€ì„œ ì‚¬ìš©
  * }
  * */
};

// case 2 - ë¦¬ì•¡íŠ¸ í•©ì„± ì´ë²¤íŠ¸ ì“¸ ë•Œ
const handleChange2: ChangeEventHandler = (e) => {
  e.target.value // valueê°€ HTMLSelectElementë¡œ ì¶”ë¡  ë¨
};
```

### í›…ì— íƒ€ì… ì¶”ê°€í•˜ê¸°

```tsx
const pets = {
  dog: "ê°•ì•„ì§€",
  cat: "ê³ ì–‘ì´",
  rabbit: "í† ë¼",
};

type Pet = keyof typeof pets;

const PetSelector = () => {
  // const [pet, changePet] = useState<string | undefined>(); // stringì¼ ë•ŒëŠ” ì•„ë˜ ìƒí™©ì—ì„œ ì—ëŸ¬ ë°œìƒí•˜ì§€ ì•ŠìŒ  
  const [pet, changePet] = useState<Pet | undefined>();

  return <Select options={pets} selectedOption={pet} onChange={() => changePet("elephant")} />; // type error
};

export default PetSelector;
```

### ì œë„¤ë¦­ ì»´í¬ë„ŒíŠ¸ ë§Œë“¤ê¸°

```tsx
import type { ChangeEventHandler } from "react";
import { useState } from "react";

const pets = {
  dog: "ê°•ì•„ì§€",
  cat: "ê³ ì–‘ì´",
  rabbit: "í† ë¼",
};

// 1) ì œë„¤ë¦­ ìƒëµ (ì¶”ë¡ )
export const Select = <O extends Record<string, string>>({
  options,
  selectedOption,
  onChange,
}: {
  options: O;
  selectedOption?: keyof O;
  onChange?: (selected?: keyof O) => void;
}) => {
  const handleChange: ChangeEventHandler<HTMLSelectElement> = (e) => {
    const selected = Object.entries(options).find(([, v]) => v === e.target.value)?.[0] as
      | keyof O
      | undefined;

    onChange?.(selected);
  };

  return (
    <select value={selectedOption ? options[selectedOption] : ""} onChange={handleChange}>
      {Object.entries(options).map(([key, value]) => (
        <option key={key} value={value}>
          {value}
        </option>
      ))}
    </select>
  );
};

type Pet = keyof typeof pets;

const PetSelector = () => {
  const [pet, setPet] = useState<Pet | undefined>();
  // return <Select<typeof pets> options={pets} selectedOption={pet} onChange={setPet} />;
  return <Select options={pets} selectedOption={pet} onChange={setPet} />; // <- ì´ë ‡ê²Œ í•´ë„ íƒ€ì… ì¶”ë¡  ë¨
};

export default PetSelector;
```

### HTMLAttributes, ReactProps ì ìš©í•˜ê¸°

className, id ê°™ì€ ê¸°ë³¸ Props ì¶”ê°€í•˜ê³  ì‹¶ì„ ë•Œ ë¦¬ì•¡íŠ¸ì—ì„œ ì œê³µí•˜ëŠ” íƒ€ì…ì„ ì“°ë©´ ë” ì •í™•í•œ íƒ€ì… ì„¤ì • ê°€ëŠ¥

```ts

type ReactSelectProps = React.ComponentPropsWithoutRef<"select">;

interface SelectProps<O extends Record<string, string>> {
    id?: ReactSelectProps["id"];
    className?: ReactSelectProps["className"]
}

// or

interface SelectProps<O extends Record<string, string>> extends Pick<ReactSelectProps, 'id' | 'className' | 'key'>{
  //...
}

```

### ê³µë³€ì„± vs ë°˜ ê³µë³€ì„±

ê³µë³€ì„± : Aê°€ Bì˜ ì„œë¸Œíƒ€ì… ì¼ ë–„, T<A>ê°€ T<B>ì˜ ì„œë¸Œíƒ€ì…ì´ë‹¤.

ì¼ë°˜ì ì¸ íƒ€ì…ë“¤ì€ ê³µë³€ì„±ì„ ê°€ì§€ê³  ìˆì–´ì„œ, ì¢ì€ íƒ€ì…ì—ì„œ ë„’ì€ íƒ€ì…ìœ¼ë¡œ í• ë‹¹ ê°€ëŠ¥

ì œë„¤ë¦­ íƒ€ì… : ë°˜ê³µë³€ì„± / ì¦‰ T<B>ê°€ T<A>ì˜ ì„œë¸Œíƒ€ì…ì´ ë˜ì–´ ì¢ì€ íƒ€ì… T<A>ì˜ í•¨ìˆ˜ë¥¼ ë„“ì€ íƒ€ì… T<B>ì˜ í•¨ìˆ˜ì— ì ìš©í•  ìˆ˜ ì—†ë‹¤.

ì‰½ê²Œ ê³µë³€ì„±, ë°˜ ê³µë³€ì„± ì´í•´í•˜ê¸°

* ê³µë³€ì„±

ì¢ì€ -> ë„“ì€ íƒ€ì…ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ

``ts
interface Basket {
  fruit: string;
}

interface AppleBasket extends Basket {
  fruit: "apple";
}

let basket: Array<Basket> = [];
let appleBasket: Array<AppleBasket> = [];

basket.push({ fruit: "apple" }, { fruit: "banana" });
appleBasket.push({ fruit: "apple" });

basket = appleBasket; // ì‚¬ê³¼ ì „ìš© ë°”êµ¬ë‹ˆëŠ” ê³¼ì¼ ë°”êµ¬ë‹ˆë¡œë„ ì“¸ ìˆ˜ ìˆìŒ
appleBasket = basket; // ğŸš¨TS2322: Type Basket[] is not assignable to type AppleBasket[] Type Basket is not assignable to type AppleBasket Types of property fruit are incompatible. Type string is not assignable to type "apple"
// ê³¼ì¼ ë°”êµ¬ë‹ˆëŠ” ì‚¬ê³¼ ì „ìš© ë°”êµ¬ë‹ˆë¡œëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ (ë°”ë‚˜ë‚˜, í¬ë„ê°€ ì˜¤ë©´ ëª» ë‹´ìœ¼ë‹ˆê¹)
``

* ë°˜ ê³µë³€ì„±


| ê³¼ì¼ ë°°ë‹¬ì› | ì‚¬ê³¼ ë°°ë‹¬ì› |
|---|---|
|ëª¨ë“  ê³¼ì¼ì„ ë°°ë‹¬í•  ìˆ˜ ìˆìŒ | ì‚¬ê³¼ë§Œ ë°°ë‹¬í•  ìˆ˜ ìˆìŒ |
| Deliver<Fruit> | Deliver<Apple> |

ê³¼ì¼ ë°°ë‹¬ì›ì— ì‚¬ê³¼ ë°°ë‹¬ì›ì„ í• ë‹¹í•  ìˆ˜ ì—†ë‹¤.
-> ëˆ„êµ°ê°€, ë°”ë‚˜ë‚˜ or í¬ë„ë¥¼ ì£¼ë¬¸í•˜ë©´ ë°°ë‹¬í•´ì¤„ ì‚¬ëŒì´ ì—†ìŒ

ì¦‰, íŒŒë¼ë¯¸í„° íƒ€ì…ì—ëŠ” ë„“ì€ -> ì¢ì€ íƒ€ì…ì´ í• ë‹¹ ì•ˆë¨

```ts
type Deliver<T> = (item: T) => void;

const deliverFruit: Deliver<Fruit> = (f) => {
  console.log("ğŸğŸŒğŸ‡ê³¼ì¼ ë°°ë‹¬ ì¤‘:", f);
};

const deliverApple: Deliver<Apple> = (a) => {
  console.log("ğŸì‚¬ê³¼ë§Œ ë°°ë‹¬ ì¤‘:", a);
};

// âœ… OK: Deliver<Fruit>ë¥¼ Deliver<Apple> ìë¦¬ì— ë„£ìŒ
let appleStation: Deliver<Apple> = deliverFruit;

// âŒ Error: Deliver<Apple>ë¥¼ Deliver<Fruit> ìë¦¬ì— ë„£ì„ ìˆœ ì—†ìŒ
let fruitStation: Deliver<Fruit> = deliverApple; // íƒ€ì… ë¶ˆì¼ì¹˜!
```
