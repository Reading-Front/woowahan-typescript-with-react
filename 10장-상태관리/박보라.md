# 10장 상태 관리

## 10.1 상태관리

1. 상태란

시간이 지나면 변하는 동적인 데이터 (고정 값이 아님)

### local state

- 컴포넌트 내부에서 관리 되는 데이터
- `useState`, `useReducer` 사용
- ex. 체크박스 여부, 폼의 입력값

### global state

- 앱 전체에서 공유하는 데이터
- `props drilling` 문제를 피하기 위한 대체제

### server state

- 외부에서 저장해야 하는 데이터
- `react-query`, `swr` 같은 외부 라이브러리 이용
- ex. 사용자 정보, 글 목록


2. 상태를 잘 관리하기 위한 가이드

- 상태가 많을 수록 리렌더링이 많이 됨 -> 성능에 영향이 감
- 따라서, 가능한 Stateless Component를 만드는게 좋음

🏁 Check Point

1️⃣ 시간이 지나도 변하지 않는 값인가? 

- 객체의 참조 동일성 유지해서 변경되지 않은 값임을 리액트가 인식하게 하는 것

- `useState`의 초기값만 지정한다.

- `useRef`를 사용한다.
    - useRef는 매 렌더링 마다 동일한 ref 객체를 제공한다.

2️⃣ 파생된 값인가?

- 부모에게서 전달받는 props이거나 기존 상태에서 계산될 수 있는 값은 상태가 아니다.

- 부모에서 전달받은 props를 상태로 관리하게 될 경우, 동일 출처가 아닌 다른 출처에서 데이터 갱신이 발생하게 됨
  - 따라서, 데이터의 정확성과 일관성을 보장하기 어려움.


```tsx
import { useState } from 'react';

type UserEmailProps = {
    initialEmail: string;
}

const UserEmail: React.VFC<UesrEmailProps> = ({ initialEmail }) => {
    const [email, setEmail] = useState(initialEmail);

    const onChangeEmail = (event: React.ChagneEvent<HTMlInputElement>) => {
        setEmail(event.target.value);
    };

    return (
        <div>
            <input type="text" value={email} onChagne={onChangeEmail}>
        </div>
    )
}

```

> 💡 데이터 상태를 동기화 하기 위해 `useEffect`를 사용하게 되면 어떻게 될까?
>
> `useEffect`를 사용한 동기화 작업은 외부 데이터 (예: `localStorage`)와 동기화 될 때만 사용해야 함.
> 내부에 존재하는 데이터 상태를 동기화 하는 경우, 개발자가 추적하기 어려운 오류가 발생할 수 있음

-> **상태 끌어올리기(Lifting Statg Up)** 기법 

```tsx
import React from 'react';

type UserEmailProps = {
    email: string;
    setEmail: React.Dispatch<React.SetStateAction<string>>;
};

export const UserEmail: React.FC<UserEmailProps> = ({ email, setEmail }) => {
    const onChangeEmail = (event: React.ChangeEvent<HTMLInputElement>) => {
        setEmail(event.target.value);
    };

    return (
        <div>
            <input type="text" value={email} onChange={onChangeEmail} />
        </div>
    );
};

```
- 단일한 출처에서 데이터가 변경되도록 한다.


3. 전역 상태 관리와 상태 관리 라이브러리

## 10.2 상태관리 라이브러리

1. mobx

2. redux

3. recoil

4. zustand

5. jotai